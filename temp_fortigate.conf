# Load UDP syslog listener only once
module(load="imudp")

# Template for clean FortiGate messages (without PRI)
template(name="FortiGateRaw" type="string" string="%rawmsg-after-pri%\n")

# Log all messages coming from specific hosts
# BEGIN FWANALYZER MANAGED HOSTS
if ($fromhost-ip == '1.1.1.1' or $fromhost-ip == '2.2.2.2') then {
    action(
        type="omfile"
        file="/var/log/fortigate.log"
        template="FortiGateRaw"
    )
    stop
}
# END FWANALYZER MANAGED HOSTS

# Fallback for other syslog messages (optional, adapt to your needs)
# if ($fromhost-ip != '192.168.100.221') then {
#     *.info;mail.none;authpriv.none;cron.none    /var/log/syslog
# }
